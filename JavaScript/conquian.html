<!DOCTYPE html>

<link rel="stylesheet" href="format.css" type="text/css" />
<body style="background:#D0D0D0 ;">
<div id="gameboard">
<ul>
	<li><a href=# class="button" style="color:white;" button onclick="endTurn()"  >Submit Move</button></a>
	<li><a href=# class="button" style="color:white;" button id="hit" onclick="endTurn()"  >End Turn</button></a>
</ul>

<p class ="Player">Computer</p>
<p id="computerHand"></p>
<p id = "comp1" class="test">a</p>
<p id = "comp2" class="test">b</p>
<p id = "comp3" class="test">c</p>
<p id = "comp4" class="test">d</p>
<p id = "comp5" class="test">e</p>
<p id = "comp6" class="test">f</p>
<p id = "comp7" class="test">g</p>
<p id = "comp8" class="test">h</p>
<p id = "comp9" class="test">i</p>
<p id="cardDrawn"></p>
<p id = "player1" class="test">a</p>
<p id = "player2" class="test">b</p>
<p id = "player3" class="test">c</p>
<p id = "player4" class="test">d</p>
<p id = "player5" class="test">e</p>
<p id = "player6" class="test">f</p>
<p id = "player7" class="test">g</p>
<p id = "player8" class="test">h</p>
<p id = "player9" class="test">i</p>
<p id="playerHand"></p>
<p class="Player">Player</p>


</body>

<script src="card.js"></script>
<script src="deck.js"></script>

<script>
//functions

//will check if the card is valid or not
var cardIsValid = function (testCard) {
	if (testCard === null)
		return false;
	if (testCard.getValue() <= 9 && testCard.getValue() >= 8)
		return false;
	return true;
};

//accepts an array that will be checked to see if its a valid move
var validMove = function (move) {
	
	if (move.length < 3)
		return false;
		
	//sorting the move array using insertion sort, since move array would always be small
	for (var i = 0; i < move.length; i++) {
		var temp = move[i];
		var j = i;
		while (j > 0 && temp < move[j-1]) {
			move[j] = move[j-1];
			j--;
		}
		move[j] = temp;
	}
	
	var counter = 0;
	//check if the cards are of the same value
	var testValue = move[0].getValue();
	for (var i = 0; i < move.length; i++)
		if (move[i].getValue() === testValue)
			counter++;
	if (counter === move.length)
		return true;
		
	counter = 0;
	var testSuit = move[0].getSuit();
	//check if the cards are in ascending order and if the suit are the same
	//first card is not tested
	for (var i = 1; i < move.length; i++) {
		//if suit are the same
		if (move[i-1].getSuit() === move[i].getSuit()) {
			//if the card is a 11 then the card before it was a 7
			if (move[i-1].getValue() + 1 === move[i].getValue())
				counter++;
			else if (move[i].getValue() === 10)
				if (move[i-1].getValue() === 7)
					counter++;
		}
	}
	
	if (counter === move.length)
		return true;
		
	return false;
	
};

//returns a string that represents the players hand used to draw on screen
var drawHand = function(hand) {
	var stringRep = "";// a var representation of the players current cards
	for (var i = 0; i < hand.length;i++) {
		stringRep += "<img src=" + hand[i].getImageSource() + " height = '125' width = '90' draggable='true'>";
	}
	return stringRep;
	
};

//returns a string that represents the players combos that will be used to draw on screen
var drawCombos = function(combos) {
	var stringRep =""//a var representation of the players combos
	var spacesTaken = 0;
	//adds the current cards
	for (var i = 0; i < combos.length; i++)
		for (var j = 0; j < combos[i].length; j++) {
			stringRep += "<img src=" + combos[i][j].getImageSource() + " height = '125' width = '90'>";
			spacesTaken++;
		}
	
	//adds a placeholder for the free space
	for (var i = 0; i < 9 - spacesTaken; i++)
		stringRep +="<img src= Images/empty.jpeg height = '125' width = '90'>"
	
	return stringRep;
};


function endTurn() {	
	var testValue;
	do {
		testValue = playDeck.drawCard();
		if (testValue === null)
			break;
	} while (!cardIsValid(testValue));
	
	if (testValue != null)
    	document.getElementById("cardDrawn").innerHTML =  "<img src=" + testValue.getImageSource() + " height = '125' width = '90'>";
	else
		console.log("you hit null");
}

function makeMove(action, whosTurn) {
	
	//draw a card and have a turn
	if (action === 0) {
		
		var drawnCard;
		do {
			drawnCard = playDeck.drawCard();
			
		} while (!cardIsValid(drawnCard) && drawnCard != null);
		//if card is not null that may mean the game is not over
		if (drawnCard != null) {
			document.getElementById("cardDrawn").innerHTML =  "<img src=" + drawnCard.getImageSource() + " height = '125' width = '90'>";
		}
	}
	//have a turn without drawing a card 
	else if (action === 1) {
	
	}	
}



//setting up
var playDeck = new Deck;

//create the starting card for the computer
var compHand = new Array();
for (var i = 0; i < 8;) {
	var temp = playDeck.drawCard();
	if (cardIsValid(temp)) {
		compHand.push(temp);
		i++;
	}
}


//create the starting cards for the second player	
var playerHand = new Array();
for (var i = 0; i < 8;) {
	var temp = playDeck.drawCard();
	if (cardIsValid(temp)) {
		playerHand.push(temp);
		i++;
	}
}
//create arrays that will hold the players combo
var compCombo = new Array();
var playerCombo = new Array();

//draw the hand of both players here
document.getElementById("computerHand").innerHTML = drawHand(compHand);
document.getElementById("playerHand").innerHTML = drawHand(playerHand);
var whosTurn = 0;
//start the game  
makeMove(0, whosTurn);
</script>
